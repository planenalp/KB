<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Klein.Blue</title>
        <link rel="icon" type="URL">
        <style>
            /* 视口高度处理 */
            html, body {
                margin: 0;
                height: calc(var(--vh, 1vh) * 100);
                display: flex;
                align-items: center;
                justify-content: center;
                /* 背景过渡 */
                transition: background-color 0.3s ease; /* 背景过渡 */
            }
            
            /* 缩放效果 */
            img {
                width: 30vmin;
                height: 30vmin;
                transition: 
                    transform 0.1s ease, /* 缩放动画 */
                    opacity 0.3s ease;  /* 淡入效果 */
                -webkit-tap-highlight-color: transparent; /* 修复某些安卓设备的点击外框 */
                -webkit-touch-callout: none; /* 禁用 iOS 长按弹出菜单 */
                -webkit-user-select: none; /* 禁用 iOS Safari 和其他 WebKit 内核浏览器的文本选择 */
                -moz-user-select: none; /* 适用于 Firefox */
                -ms-user-select: none; /* 适用于 IE10+ 和 Edge */
                user-select: none; /* 标准语法 */
                outline: none;
            }
            
            @media (any-hover: hover) {
                img:hover {
                    transform: scale(1.1);
                }
            }
            
            img:active {
                transform: scale(0.9);
            }

            a {
                display: inline-block;
                text-decoration: none;
                -webkit-tap-highlight-color: transparent; /* 修复某些安卓设备的点击外框 */
                -webkit-touch-callout: none; /* 禁用 iOS 长按弹出菜单 */
                -webkit-user-select: none; /* 禁用 iOS Safari 和其他 WebKit 内核浏览器的文本选择 */
                -moz-user-select: none; /* 适用于 Firefox */
                -ms-user-select: none; /* 适用于 IE10+ 和 Edge */
                user-select: none; /* 标准语法 */
            }
        </style>
    </head>
    <body>
        <!-- 链接结构 -->
        <a href="https://international.klein.blue/">
            <img id="theme-logo" alt="Logo">
        </a>

        <script>
            // 视口高度计算逻辑
            function setVh() {
                const vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
            }

            // 添加触摸事件支持允许移动端实现图标按压特效
            document.addEventListener('touchstart', function() {}, { passive: true });
            document.addEventListener('touchend', function() {}, { passive: true });

            // 主题系统
            const themes = [
                // avatar-whitesmoke.svg
                { background: "#002fa7", logo: "URL" },
                // avatar-blue.svg
                { background: "#f5f5f5", logo: "URL" }
            ];

            // 预加载 logo 图片，确保切换时图像已缓存，从而减少移动端延迟
            themes.forEach(theme => {
                const img = new Image();
                img.src = theme.logo;
            });

            // 用于记录当前主题下标
            let currentThemeIndex = 0;

            function applyTheme(theme) {
                // 同步设置背景颜色并触发 CSS 过渡效果
                document.body.style.backgroundColor = theme.background;

                const logo = document.getElementById('theme-logo');
                
                // 立即更新 logo 源（图片采用预加载）
                logo.src = theme.logo;
                // 立即将 logo 设为透明
                logo.style.opacity = 0;
                // 强制浏览器重排，确保上述样式立即生效
                void logo.offsetWidth;
                // 立刻触发透明度变化，使 logo 与背景色同步淡入
                logo.style.opacity = 1;
            }

            function toggleTheme() {
                // 在两个主题之间切换
                currentThemeIndex = currentThemeIndex === 0 ? 1 : 0;
                applyTheme(themes[currentThemeIndex]);
            }

            // 初始化流程
            function init() {
                setVh();
                // 随机选择一个主题作为默认
                currentThemeIndex = Math.random() < 0.5 ? 0 : 1;
                applyTheme(themes[currentThemeIndex]);
            }

            // 点击 logo 以外区域切换主题
            const logoLink = document.querySelector('a[href="https://international.klein.blue/"]');
            document.addEventListener('click', function(e) {
                // 如果点击目标不在 logoLink 或其子元素中，则切换主题
                if (!logoLink.contains(e.target)) {
                    toggleTheme();
                }
            });

            // 保留窗口resize监听
            window.addEventListener('resize', setVh);
            init();
        </script>
    </body>
</html>
